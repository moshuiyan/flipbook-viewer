!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("flipbook",[],e):"object"==typeof exports?exports.flipbook=e():t.flipbook=e()}(self,(()=>(()=>{"use strict";var t={702:t=>{function e(t){let e=document.createElement(t.tag);return o(e),e.attr(t.attr),e.add(t.children),e}function o(t){if(t)return t.c||(t.c=function(){return 1===arguments.length&&"string"==typeof arguments[0]?t.innerHTML=arguments[0]:(t.innerHTML="",arguments.length&&s(t,Array.prototype.slice.call(arguments))),t}),t.attr=e=>r(t,e),t.add=e=>s(t,e),t.rm=e=>t.removeChild(e),t.addClass=e=>function(t,e){if(t.classList&&t.classList.add)return t.classList.add(e);const o=t.getAttribute("class");o?t.setAttribute("class",`${o} ${e}`):t.setAttribute("class",e)}(t,e),t.rmClass=e=>function(t,e){if(t.classList&&t.classList.remove)return t.classList.remove(e);const o=t.getAttribute("class");if(!o)return;const n=o.split(" ").filter((t=>t!==e)).join(" ");t.setAttribute("class",n)}(t,e),t}function n(t,e,o,n){const i={tag:null,attr:{},children:[]};return r(e),r(o),r(n),i;function r(e){if(!i.tag){if(!e)return void(i.tag=t);if("string"==typeof e)return void(i.tag=e);i.tag=t}e&&(Array.isArray(e)||a(e)||"string"==typeof e||"number"==typeof e?i.children=i.children.concat(e):i.attr=Object.assign(i.attr,e))}}function i(t,e,o){o.class&&o.classes?o.class+=" "+o.classes:o.classes?o.class=o.classes:o.class||(o.class=""),delete o.classes;let n=(e=e.replace(/#/g,".#")).split(".");(e=n.shift())||(e=t);for(let t=0;t<n.length;t++)"#"==n[t][0]?o.id||(o.id=n[t].substring(1)):o.class+=" "+n[t];return o.class||delete o.class,e}function r(t,e){if(e)for(let o in e)if("class"===o||"classes"===o){if(e[o]){const n=t.getAttribute("class");let i=e[o].trim().split(/[ \t]+/g).join(" ");n&&(i+=" "+n),t.setAttribute("class",i)}}else if("style"===o){let n=e[o];if("string"==typeof n)t.style.cssText=n;else for(let e in n)t.style.setProperty(e,n[e])}else o.startsWith("on")?t.addEventListener(o.substring(2).toLowerCase(),e[o]):!1===e[o]?t.removeAttribute(o):e[o]?t.setAttribute(o,e[o]):t.setAttribute(o,"")}function s(t,e){if(e){Array.isArray(e)||(e=[e]);for(let o=0;o<e.length;o++){let n=e[o];n&&(Array.isArray(n)?s(t,n):(a(n)||(n=document.createTextNode(n)),t.appendChild(n)))}}}function a(t){return t&&t.nodeName&&t.nodeType}function c(t,o){let r=n("div",t,o);return r.tag=i("div",r.tag,r.attr),(t,o,s)=>{let a=n("div",t,o,s);return a.tag=i("div",a.tag,a.attr),r.attr.class&&a.attr.class&&(a.attr.class=r.attr.class+" "+a.attr.class),r.attr.style&&a.attr.style&&typeof r.attr.style==typeof a.attr.style&&("string"==typeof r.attr.style?a.attr.style=r.attr.style+";"+a.attr.style:a.attr.style=Object.assign({},r.attr.style,a.attr.style)),a.attr=Object.assign({},r.attr,a.attr),e(a)}}t.exports={h:function(t,o,r){let s=n("div",t,o,r);return s.tag=i("div",s.tag,s.attr),e(s)},wrap:o,getH:function(t,e){return t instanceof Element?o(t):(e||(e=document),e.contentDocument&&(e=e.contentDocument),o(e.getElementById(t)))},x:c,div:c("div"),svg:function(t,e,a){let c,l=n("svg",t,e,a);if(l.tag=i("svg",l.tag,l.attr),"<"==l.tag[0]){c=document.createElementNS("http://www.w3.org/2000/svg","svg"),c.innerHTML=t;const e=c.getElementsByTagName("svg")[0];e&&(c=e)}else c=document.createElementNS("http://www.w3.org/2000/svg",l.tag),r(c,l.attr),s(c,l.children);return o(c),c}}}},e={};function o(n){var i=e[n];if(void 0!==i)return i.exports;var r=e[n]={exports:{}};return t[n](r,r.exports,o),r.exports}o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return(()=>{o.r(n),o.d(n,{init:()=>u});var t=o(702);class e extends EventTarget{}const i=window.devicePixelRatio||1;function r(o,n){const r=new e;r.page_count=o.book.numPages(),function(e,o){const n={e:(0,t.h)("canvas")};n.ctx=n.e.getContext("2d"),n.e.width=Math.floor(e.sz.boxw*i),n.e.height=Math.floor(e.sz.boxh*i),n.e.style.width=Math.floor(e.sz.boxw)+"px",n.e.style.height=Math.floor(e.sz.boxh)+"px",e.canvas=n,o()}(o,(t=>{if(t)return n(t);!function(t,e){const o=t.sz.boxw*i,n=t.sz.boxh*i;t.book.getPage(1,((i,r)=>{if(i)return e(i);const s=1-t.sz.marginTop/100;let a=n*s;const c=1-t.sz.marginLeft/100;let l=2*r.width*(a/r.height);const f=o*c;l>f&&(l=f,a=r.height*(l/(2*r.width))),t.layout={top:(n-a)/2,left:(o-l)/2,mid:o/2,width:l,height:a},e()}))}(o,(t=>{if(t)return n(t);o.app.c(o.canvas.e),function(t,e){const o=[s(t,e)],n={};["onmouseenter","onmouseleave","onmousemove","onclick","onmousedown","onmouseup"].map((t=>{n[t]=e=>{o.map((o=>{o[t]&&o[t](e)}))}})),t.app.attr(n)}(o,r),o.zoom=0,o.showNdx=0,function(t,e){function o(t){f({draw:o=>{t.flipFrac=o.flipFrac,function(t,e){l(t,e);const o=t.canvas,n=2*t.flipNdx,i=n+1,r=c(t),s=.5-Math.abs(.5-t.flipFrac);function a(e,n){o.ctx.fillStyle=e;const i=t.sz.bx_border;o.ctx.fillRect(n.left-i,n.top-i-5,n.width+2*i,n.height+2*i+10)}function f(t,e){const o=t.sz.bx_border;return{left:e.left-o,top:e.top-o,width:e.width+2*o,height:e.height+2*o}}o.ctx.save(),t.book.getPage(n,((e,n)=>{if(e)return console.error(e);t.book.getPage(i,((e,i)=>{if(e)return console.error(e);!function(e,n,i,c){let l,d,g,h,u,p,x,m,b;if(t.showNdx<t.flipNdx){l=Object.assign({},r),l.width/=2,l.left=r.mid,d=l.left+(1-i)*l.width,g=l.width*i,u=f(t,l),o.ctx.save(),h=new Path2D,h.rect(d,u.top-5,g,u.height+10),o.ctx.clip(h),n?o.ctx.drawImage(n.img,l.left,l.top,l.width,l.height):a(t.color.bg,u),o.ctx.restore(),l=Object.assign({},r),l.left+=(1-i)*l.width,l.width/=2,g=l.width*i,p=l.height,x=l.top,l.height*=1+.1*s,l.top-=(l.height-p)/2,o.ctx.save(),h=new Path2D,h.moveTo(l.left,x),h.lineTo(l.left,x+p),m={x:l.left+g/2,y:l.top+l.height},b={x:l.left+g,y:x+p},h.quadraticCurveTo(m.x,m.y,b.x,b.y),h.lineTo(b.x,x),m={x:l.left+g,y:l.top},b={x:l.left,y:x},h.quadraticCurveTo(m.x,m.y,b.x,b.y),o.ctx.clip(h),o.ctx.drawImage(e.img,l.left,l.top,l.width,l.height),o.ctx.restore(),o.ctx.save();const c=l.width/2*Math.max(Math.min(s,.5),0);o.ctx.strokeStyle="rgba(0,0,0,"+.1*s+")",o.ctx.lineWidth=30*s,o.ctx.beginPath(),o.ctx.moveTo(l.left,x),o.ctx.lineTo(l.left,x+p),o.ctx.stroke();let w=o.ctx.createLinearGradient(l.left+g,x,l.left+g+c,x);w.addColorStop(0,"rgba(0,0,0,"+.3*s+")"),w.addColorStop(.8,"rgba(0,0,0,0.0)"),o.ctx.fillStyle=w,o.ctx.fillRect(l.left+g,x,g+c,p),o.ctx.restore()}else{l=Object.assign({},r),l.width/=2,g=l.width*i+t.sz.bx_border,u=f(t,l),o.ctx.save(),h=new Path2D,h.rect(u.left,u.top-5,g,u.height+10),o.ctx.clip(h),e?o.ctx.drawImage(e.img,l.left,l.top,l.width,l.height):a(t.color.bg,l),o.ctx.restore(),l=Object.assign({},r),l.width/=2,d=l.left+i*l.width,l.left=d-(1-i)*l.width,g=l.width*i,p=l.height,x=l.top,l.height*=1+.1*s,l.top-=(l.height-p)/2,o.ctx.save(),h=new Path2D,h.moveTo(d,x),h.lineTo(d,x+p),m={x:d+g/2,y:l.top+l.height},b={x:d+g,y:x+p},h.quadraticCurveTo(m.x,m.y,b.x,b.y),h.lineTo(b.x,x),m={x:d+g,y:l.top},b={x:d,y:x},h.quadraticCurveTo(m.x,m.y,b.x,b.y),o.ctx.clip(h),o.ctx.drawImage(n.img,l.left,l.top,l.width,l.height),o.ctx.restore(),o.ctx.save();const c=l.width/2*Math.max(Math.min(s,.5),0);o.ctx.strokeStyle="rgba(0,0,0,"+.1*s+")",o.ctx.lineWidth=30*s,o.ctx.beginPath(),o.ctx.moveTo(d+g,x),o.ctx.lineTo(d+g,x+p),o.ctx.stroke();let w=o.ctx.createLinearGradient(d,x,d-c,x);w.addColorStop(0,"rgba(0,0,0,"+.3*s+")"),w.addColorStop(.8,"rgba(0,0,0,0.0)"),o.ctx.fillStyle=w,o.ctx.fillRect(d-c,x,c,p),o.ctx.restore()}c()}(n,i,t.flipFrac,(()=>o.ctx.restore()))}))}))}(t,e)},duration:1111,from:{flipFrac:0},to:{flipFrac:1},timing:t=>t*t*(3-2*t),ondone:()=>{t.showNdx=t.flipNdx,t.flipNdx=null,l(t,e)}})}e.zoom=o=>{o=Number(o),isNaN(o)&&(o=2*t.zoom+1)>4&&(o=0),o?f({draw:o=>{t.zoom=o.zoom,l(t,e)},duration:500,from:{zoom:t.zoom},to:{zoom:o},timing:t=>t*t*(3-2*t)}):(t.zoom=0,t.pan=null,l(t,e))},e.flip_forward=()=>{t.flipNdx||0===t.flipNdx||t.book.numPages()<=1||2*t.showNdx+1>=t.book.numPages()||(t.flipNdx=t.showNdx+1,o(t))},e.flip_back=()=>{t.flipNdx||0===t.flipNdx||t.book.numPages()<=1||t.showNdx&&(t.flipNdx=t.showNdx-1,o(t))}}(o,r),n(null,r),l(o,r)}))}))}function s(t,e){let o;return{onmouseleave:function(t){o=null},onmousedown:function(e){t.zoom&&(o=a(t,e),t.pan&&(o.x-=t.pan.x,o.y-=t.pan.y))},onmouseup:function(t){o=null},onmousemove:function(n){const i=a(t,n);o&&function(t,e){const o=function(t){const e=c(t);return{top:e.top,left:e.left,bottom:e.top+e.height,right:e.left+e.width}}(t);return o.top<=e.y&&o.bottom>=e.y&&o.left<=e.x&&o.right>=e.x}(t,i)?(t.pan={x:i.x-o.x,y:i.y-o.y},l(t,e)):o=null}}}function a(t,e){const o=t.app.getBoundingClientRect();return{x:e.clientX-o.x,y:e.clientY-o.y}}function c(t){let e=t.layout;if(t.zoom>0){if(e=Object.assign({},e),t.zoom){const o=.5*t.zoom;e.left=e.left-e.width*o/2,e.top=e.top-e.height*o/2,e.width=e.width*(1+o),e.height=e.height*(1+o)}t.pan&&(e.left+=t.pan.x,e.top+=t.pan.y,e.mid+=t.pan.x)}return e}function l(t,e){const o=t.canvas,n=2*t.showNdx,r=n+1;function s(t,e){o.ctx.drawImage(t.img,e.left,e.top,e.width,e.height)}o.ctx.save(),o.ctx.fillStyle=t.color.bg,o.ctx.fillRect(0,0,t.sz.boxw*i,t.sz.boxh*i),t.book.getPage(n,((i,a)=>{if(i)return console.error(i);!t.flipNdx&&0!==t.flipNdx&&a&&e.dispatchEvent(new CustomEvent("seen",{detail:n})),t.book.getPage(r,((n,i)=>{if(n)return console.error(n);!t.flipNdx&&0!==t.flipNdx&&i&&e.dispatchEvent(new CustomEvent("seen",{detail:r})),function(e,n,i){const r=c(t);0==t.zoom&&function(e){o.ctx.fillStyle=t.color.bx;const n=t.sz.bx_border;o.ctx.fillRect(e.left-n,e.top-n,e.width+2*n,e.height+2*n)}(r);const a=Object.assign({},r),l=Object.assign({},r);a.width/=2,l.width/=2,l.left=r.mid,e&&s(e,a),n&&s(n,l),o.ctx.restore()}(a,i)}))}))}function f({draw:t,duration:e,from:o,to:n,timing:i,ondone:r}){r||(r=()=>1),i||(i=t=>t);const s=Date.now();!function a(){let c=(Date.now()-s)/e;c>1&&(c=1);const l=function(t){t=i(t);const e=Object.assign({},o);for(let i in o){const r=Number(o[i]),s=Number(n[i]);e[i]=r+(s-r)*t}return e}(c);t(l),1===c?r():requestAnimationFrame(a)}()}class d extends EventTarget{}const g=e=>(0,t.h)(`canvas#flipbook__pgnum_${e}.flipbook__page`),h={rE:"1.6.1"};function u(e,o,n,i){"function"==typeof n&&(i=n,n={}),n||(n={}),i||(i=()=>1);const s=(0,t.getH)(o);if(!s){const t="flipbook-viewer: Failed to find container for viewer: "+o;return console.error(t),void i(t)}if(n.singlepage)!function(t,e){const o=new d;o.page_count=t.book.numPages(),function(t,e){const o=g(0);t.app.c(o),setTimeout((()=>{t.page_width=o.getBoundingClientRect().width,t.app.rm(o),e()}))}(t,(n=>{if(n)return e(n);!function(t,e){const o=window.devicePixelRatio||1,n=t.book.pdf;t.pages=[],function i(r){if(r>=n.numPages)return e();const s=r+1;n.getPage(s).then((n=>{const a=n.getViewport({scale:1}),c=t.page_width/a.width,l=n.getViewport({scale:c}),f=g(s);f.attr({"data-flipbook-page":s}),f.width=Math.floor(l.width*o),f.height=Math.floor(l.height*o),f.style.width=Math.floor(l.width)+"px",f.style.height=Math.floor(l.height)+"px",t.pages.push(f),t.app.add(f);const d=1!==o?[o,0,0,o,0,0]:null,h={canvasContext:f.getContext("2d"),transform:d,viewport:l};n.render(h).promise.then((()=>i(r+1))).catch((t=>e(t||"Failed rendering page"+s)))})).catch((t=>e(t||"Failed getting page:"+s)))}(0)}(t,(n=>{if(n)return e(n);e(null,o),function(t,e){const o={},n=new IntersectionObserver((function(t){t.forEach((t=>{if(t.intersectionRatio)try{const n=t.target.dataset.flipbookPage;if(o[n])return;o[n]=!0,e.dispatchEvent(new CustomEvent("seen",{detail:n}))}catch(t){console.error(t)}}))}),{root:null,rootMargin:"0px",threshold:.25});t.pages.forEach((t=>n.observe(t)))}(t,o)}))}))}({app:s,book:e},a);else{const t={color:{bg:n.backgroundColor||"#353535"},sz:{bx_border:n.boxBorder||0,boxw:n.width||800,boxh:n.height||600},app:s,book:e},o=n.margin||1;n.marginTop||0===n.marginTop?t.sz.marginTop=n.marginTop:t.sz.marginTop=o,n.marginLeft||0===n.marginLeft?t.sz.marginLeft=n.marginLeft:t.sz.marginLeft=o,r(t,a)}function a(t,e){return n.popup&&history.pushState({},"","#"),e&&(e.version=h.rE),i(t,e)}}})(),n})()));